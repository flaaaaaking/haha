<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MBTI 决策工具 v1.0 | 全功能单页版</title>
<style>
:root {
  --bg: #0c0f13; --panel: #151922; --text: #e8ecf2; --muted: #9aa3b2; --btn: #4a90e2; --line: #242a34;
}
body {background: var(--bg); color: var(--text); font-family: system-ui, sans-serif; margin: 0; padding: 20px;}
h1 {text-align: center; margin-bottom: 16px;}
.grid {display: grid; grid-template-columns: 1fr 1.2fr 1fr; gap: 16px; max-width: 1200px; margin: auto;}
.card {background: var(--panel); border: 1px solid var(--line); border-radius: 8px; padding: 16px; box-shadow: 0 0 4px rgba(0,0,0,.3);}
select, input, textarea {width: 100%; background: #1b2029; color: var(--text); border: 1px solid #2a3140; border-radius: 6px; padding: 8px; margin-top: 4px;}
.btn {background: var(--btn); color: white; border: none; border-radius: 6px; padding: 8px 14px; cursor: pointer; margin-top: 8px;}
.list div {padding: 4px 0; border-bottom: 1px dashed var(--line);}
.result {white-space: pre-wrap; background: #1b2029; padding: 8px; border-radius: 6px; margin-top: 8px;}
</style>
</head>
<body>
<h1>MBTI 决策工具 v1.0（单页离线版）</h1>
<div class="grid">
  <div class="card">
    <h2>参数</h2>
    <label>类型（16 型）</label>
    <select id="type"></select>

    <label>项目阶段</label>
    <select id="phase">
      <option>探索</option>
      <option>0→1</option>
      <option>增长</option>
      <option>重构</option>
      <option>合规</option>
    </select>

    <label>目标（多选）</label>
    <div id="goals"></div>

    <label>任务 / 问题</label>
    <textarea id="tasks" rows="6" placeholder="一行一个，例如：\n修厨房水槽\n准备周会PPT\n健身计划...\n"></textarea>

    <button class="btn" id="analyze">生成决策</button>
  </div>

  <div class="card">
    <h2>功能权重（解释性） <button class="btn" id="explain">解释</button></h2>
    <div id="weights" class="list"></div>
  </div>

  <div class="card">
    <h2>结果与建议</h2>
    <div id="result" class="result">尚未生成</div>
    <button class="btn" id="copyMd">复制 Markdown</button>
  </div>
</div>

<script>
const MBTI_STACKS = {
  INTJ:['Ni','Te','Fi','Se','Ne','Ti','Fe','Si'], INFJ:['Ni','Fe','Ti','Se','Ne','Te','Fi','Si'],
  INTP:['Ti','Ne','Si','Fe','Te','Ni','Se','Fi'], INFP:['Fi','Ne','Si','Te','Fe','Ni','Se','Ti'],
  ENTJ:['Te','Ni','Se','Fi','Ti','Ne','Si','Fe'], ENFJ:['Fe','Ni','Se','Ti','Fi','Ne','Si','Te'],
  ENTP:['Ne','Ti','Fe','Si','Ni','Te','Fi','Se'], ENFP:['Ne','Fi','Te','Si','Ni','Fe','Ti','Se'],
  ISTJ:['Si','Te','Fi','Ne','Se','Ti','Fe','Ni'], ISFJ:['Si','Fe','Ti','Ne','Se','Fi','Te','Ni'],
  ISTP:['Ti','Se','Ni','Fe','Te','Si','Ne','Fi'], ISFP:['Fi','Se','Ni','Te','Fe','Si','Ne','Ti'],
  ESTJ:['Te','Si','Ne','Fi','Ti','Se','Ni','Fe'], ESFJ:['Fe','Si','Ne','Ti','Fi','Se','Ni','Te'],
  ESTP:['Se','Ti','Fe','Ni','Si','Te','Fi','Ne'], ESFP:['Se','Fi','Te','Ni','Si','Fe','Ti','Ne']
};
const GROUP_COLOR = {
  N:['#a78bfa'], S:['#4ade80'], T:['#60a5fa'], F:['#facc15']
};
const GOALS = ['效率','稳健','探索','体验','可扩展'];
const PHASE_WEIGHTS = {
  '探索':{Ne:.3,Ni:.2,Se:.1,Fi:.1,Ti:.1,Fe:.05,Te:.05,Si:.05},
  '0→1':{Ni:.25,Te:.25,Se:.15,Ti:.1,Fi:.05,Fe:.05,Ne:.1,Si:.05},
  '增长':{Te:.2,Fe:.15,Ne:.15,Ni:.1,Se:.1,Si:.1,Fi:.1,Ti:.05},
  '重构':{Ti:.25,Si:.2,Ni:.15,Te:.15,Fe:.1,Se:.1,Fi:.05,Ne:0},
  '合规':{Si:.25,Te:.25,Fe:.15,Ti:.15,Fi:.1,Se:.05,Ni:.05,Ne:.0}
};

const typeSel=document.getElementById('type');Object.keys(MBTI_STACKS).forEach(t=>{const o=document.createElement('option');o.text=t;typeSel.add(o)});
const goalsDiv=document.getElementById('goals');GOALS.forEach(g=>{const l=document.createElement('label');l.innerHTML=`<input type='checkbox' value='${g}'> ${g}`;goalsDiv.appendChild(l);});

function analyze(){
  const type=typeSel.value;const phase=document.getElementById('phase').value;
  const goals=[...document.querySelectorAll('#goals input:checked')].map(i=>i.value);
  const tasks=document.getElementById('tasks').value.trim().split(/\n+/).filter(x=>x);
  if(!tasks.length)return alert('请输入任务');
  const base=Object.fromEntries(['Ni','Ne','Si','Se','Fi','Fe','Ti','Te'].map(f=>[f,0]));
  const stack=MBTI_STACKS[type];stack.forEach((f,i)=>base[f]+=1/(i+1));
  const phaseW=PHASE_WEIGHTS[phase];Object.keys(phaseW).forEach(k=>base[k]+=phaseW[k]);
  goals.forEach(g=>{if(g==='效率')base.Te+=.2;if(g==='稳健')base.Si+=.2;if(g==='探索')base.Ne+=.2;if(g==='体验')base.Fe+=.2;if(g==='可扩展')base.Ni+=.2;});
  const weights=Object.entries(base).sort((a,b)=>b[1]-a[1]);
  const top=weights[0][0];const summary=`主要功能：${top}  (${(weights[0][1]*100).toFixed(1)}%)\n`+weights.map(([k,v])=>`${k}: ${(v*100).toFixed(1)}%`).join('\n');
  document.getElementById('weights').innerText=summary;
  const taskScore=tasks.map(t=>({task:t,score:Math.random()})).sort((a,b)=>b.score-a.score);
  const lines=taskScore.map((t,i)=>`${i+1}. ${t.task}`).join('\n');
  document.getElementById('result').innerText=`【建议优先级】\n${lines}`;
}
document.getElementById('analyze').onclick=analyze;

document.getElementById('copyMd').onclick=()=>{
  const md=`# MBTI 决策报告\n类型：${typeSel.value}\n阶段：${document.getElementById('phase').value}\n\n## 功能权重\n${document.getElementById('weights').innerText}\n\n## 决策结果\n${document.getElementById('result').innerText}`;
  navigator.clipboard.writeText(md);alert('Markdown 已复制');
};

typeSel.onchange=()=>{const first=typeSel.value[1];document.body.style.setProperty('--btn',GROUP_COLOR[first]||'#4a90e2');};
</script>
</body>
</html>
